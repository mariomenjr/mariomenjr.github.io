<!doctype html> <html lang=es> <head> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-174920898-1"></script> <script> window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-174920898-1'); </script> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <meta content=website property=og:type> <base href=/ > <link href=manifest.json rel=manifest crossorigin=use-credentials> <link href=favicon.png rel=icon type=image/png> <link href=client/main.393438101.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Blog | Mario Menjívar</title><meta content=summary_large_image property=twitter:card><meta content=https://mariomenjr.com/blog property=twitter:url><meta content="Blog | Mario Menjívar" property=twitter:title><meta content="1 post(s)" property=twitter:description><noscript id=sapper-head-end></noscript> </head> <body class="box-border antialiased bg-white overflow-x-hidden text-gray-900"> <div id=sapper> <div class="box-border min-h-screen min-w-screen"><div class="flex justify-between flex-col h-100"><div><header class=px-4><div class="container mx-auto mt-2 px-2 py-4 sm:px-1 sm:py-2"><div class="flex flex-row items-center justify-between"><div class=inline-block><a href=/ ><div class="flex flex-row items-center"><img alt=@mariomenjr class="rounded-full sm:w-16 w-12" src="https://avatars3.githubusercontent.com/u/1946936?s=460&v=4"> <div class="flex flex-col ml-3"><span class="font-bold sm:text-xl text-grey-800 text-lg">Mario Menjívar</span> <span class="font-light text-grey-600 text-left text-xs">@mariomenjr</span></div></div></a></div> <div class=inline-block><div class="flex flex-row items-center"><a href=https://twitter.com/mariomenjr target=_blank><svg class="text-gray-900 fill-current h-6 w-6" viewBox="0 0 50 50" xmlns=http://www.w3.org/2000/svg><path d="M50.063 10.438a20.57 20.57 0 01-5.91 1.62 10.309 10.309 0
          004.523-5.687 20.648 20.648 0 01-6.531 2.492 10.258 10.258 0
          00-7.504-3.246c-5.68 0-10.286 4.602-10.286 10.281 0 .805.094 1.59.27
          2.344-8.547-.43-16.121-4.523-21.195-10.746a10.243 10.243 0 00-1.39
          5.172c0 3.566 1.812 6.715 4.573 8.562a10.274 10.274 0
          01-4.66-1.289v.13c0 4.984 3.547 9.136 8.246 10.085a10.29 10.29 0
          01-4.644.172c1.312 4.082 5.11 7.063 9.605 7.145A20.613 20.613 0 012.39
          41.87c-.831 0-1.648-.047-2.449-.144a29.053 29.053 0 0015.762
          4.62c18.914 0 29.258-15.667 29.258-29.253
          0-.446-.012-.895-.027-1.332a20.904 20.904 0 005.129-5.325z"></path></svg></a> <span class=w-5></span> <a href=https://linkedin.com/in/mariomenjr target=_blank><svg class="text-gray-900 fill-current h-6 w-6" viewBox="0 0 50 50" xmlns=http://www.w3.org/2000/svg><path d="M41 4H9C6.24 4 4 6.24 4 9v32c0 2.76 2.24 5 5 5h32c2.76 0 5-2.24
          5-5V9c0-2.76-2.24-5-5-5zM17 20v19h-6V20h6zm-6-5.53c0-1.4 1.2-2.47
          3-2.47s2.93 1.07 3 2.47c0 1.4-1.12 2.53-3 2.53-1.8 0-3-1.13-3-2.53zM39
          39h-6V29c0-2-1-4-3.5-4.04h-.08C27 24.96 26 27.02 26
          29v10h-6V20h6v2.56S27.93 20 31.81 20c3.97 0 7.19 2.73 7.19 8.26V39z"></path></svg></a></div></div></div></div></header> <nav class="px-4 border-b mt-2"><div class="container mx-auto"><div class="flex flex-row items-center justify-between"><ul class="flex flex-row items-center space-x-8"><li class="px-2 border-gray-900 py-2 border-b"><a href=/blog class="text-gray-900 font-light hover:text-black text-sm tracking-wide uppercase">blog</a> </li> </ul><ul class="flex flex-row items-center space-x-8"><li class="px-2 border-gray-900 py-2"><a href=/about class="text-gray-900 font-light hover:text-black text-sm tracking-wide uppercase">about</a> </li> </ul></div></div></nav></div> <div class="px-4 bg-gray-200"><div class="container mx-auto"><div class="gap-2 grid grid-cols-4"><div class="col-span-4 sm:col-span-3"><div class=box-border><main class=py-8> <ul><li><a href=blog/2020/08/09/como-crear-un-blog-a-base-de-markdown-y-javascript rel=prefetch>Cómo crear un blog a base de markdown y javascript</a> <p class=c-label-last-updated>Posteado en 8/9/2020, 5:23:17 PM por Mario Menjívar</p> </ul></main></div></div> <div class="col-span-4 sm:col-span-1"><div class=box-border><main class=py-8><p class="text-xs text-gray-400 tracking-wide uppercase">No entries</main></div></div></div></div></div> <footer class="box-border border-t px-4"><div class="container mx-auto py-8 text-sm">2020 © Mario Menjívar</div></footer></div></div></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,{posts:[{author:"Mario Menjívar",slug:"como-crear-un-blog-a-base-de-markdown-y-javascript",title:"Cómo crear un blog a base de markdown y javascript",timestamp:new Date(1596993797000),brief:"Seguramente te haz hecho la siguiente pregunta: ¿Cómo hostear un blog que sea fácil de mantener, sin pagar un centavo? En este post te explico una de tantas alternativas.",keywords:"javascript,svelte,blog,markdown,howto",endpoint:"2020\u002F08\u002F09\u002Fcomo-crear-un-blog-a-base-de-markdown-y-javascript",content:"\n# Cómo crear un blog a base de markdown y JavaScript\n\nSeguramente te haz hecho la siguiente pregunta: ¿Cómo hostear un blog que sea fácil de mantener, sin pagar un centavo? En este post te explico una de tantas alternativas.\n\n## Porqué\n\nOtra pregunta que probablemente este en tu cabeza es ¿Por qué markdown y JavaScript? La respuesta es un poco más elaborada. Para empezar, ¿Qué es markdown? Según Wikipedia, \n\n\u003E \"Markdown es un lenguaje de marcado ligero que trata de conseguir la máxima legibilidad y facilidad de publicación tanto en su forma de entrada como de salida, inspirándose en muchas convenciones existentes para marcar mensajes de correo electrónico usando texto plano\" de [Wikipedia](https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FMarkdown).\n\nAl usar markdown para escribir un post, estamos estructurando nuestro contenido sin necesidad de incluir HTML o CSS en el momento. Es decir, nos enfocamos enteramente en lo importante: el texto. Esta simplicidad se verá potencializada al incluir _Git_ y _Github_ en la formula, ya que podremos versionar nuestro contenido.\n\nComo mencioné, hay muchas alternativas para lograrlo. Fundamentalmente una página web no es más que HTML, CSS y JavaScript. Herramientas como [_Jekyll_](https:\u002F\u002Fjekyllrb.com\u002F), aprovechan esta regla de oro para ayudarte a generar y administrar posts fácilmente haciendo uso de markdown. Pero, ¿Qué pasa si queremos tomar ventaja de todas las herramientas disponibles en el ecosistema JavaScript que se han establecido en los últimos 10 años?  Para eso tenemos [_Gatsby_](https:\u002F\u002Fwww.gatsbyjs.org\u002F), [_Next.js_](https:\u002F\u002Fnextjs.org\u002F) o [_Sapper_](https:\u002F\u002Fsapper.svelte.dev\u002Fdocs).\n\n_In a nutshell_, estos tres frameworks permiten generar sitios estáticos haciendo uso de herramientas modernas como React o Svelte. En este post nos centraremos en _Sapper_.\n\n## ¿Por qué _Sapper_?\n\nSvelte es el nuevo chico de la cuadra. Su propuesta insignia es mover la reactividad de la UI desde mediadores como el Virtual DOM hacia el lenguaje, o mejor dicho, al compilador, en contraste con React o Vue. Esto aumenta el desempeño de las aplicaciones y disminuye el tamaño del _bundle_.\n\nPuedes echar un vistazo a la [comparativa](https:\u002F\u002Fwww.swyx.io\u002Fwriting\u002Fsvelte-static\u002F) entre Gatsby y Sapper realizada por [Shawn Wang](https:\u002F\u002Ftwitter.com\u002Fswyx), un popular desarrollador en [egghead.io](https:\u002F\u002Fegghead.io\u002F). Se muestra una reducción del 93% en el tamaño del _bundle_ con _Sapper_.\n\n## Setup\n\nPara instalar Sapper, basta con ejecutar los siguientes comandos:\n\n```bash\n[user@host ~]$ npx degit \"sveltejs\u002Fsapper-template#rollup\" my-blog\n[user@host ~]$ cd my-blog\n[user@host my-blog]$ npm install\n[user@host my-blog]$ npm run dev\n```\n\nEn el folder del projecto _my-blog_, nos interesan los siguientes files:\n\n```text\n...\n├ src\n│ ├ routes\n| | ├ blog\n| | | ├ _posts.js\n| | | ├ [slug].json.js\n| | | ├ [slug].svelte\n| | | ├ index.json.js\n| | | ├ index.svelte\n...\n```\n\nDe paso creamos el siguiente directorio y archivo:\n\n```text\n...\n+ ├ content\n+ │ ├ 2020-08-08_hola-mundo.md\n  ├ src\n  │ ├ routes\n...\n```\n\nNecesitamos instalar los siguientes paquetes:\n\n```bash\n[user@host my-blog]$ npm i gray-matter highlight.js marked\n```\n\nEn mi caso, quiero que los posts estén ordenados por su fecha de publicación y que esto se refleje en la URL. Tendremos que hacer unos cambios a los siguientes archivos:\n\n```text\n...\n- | | | ├ [slug].json.js\n- | | | ├ [slug].svelte\n+ | | | ├ [...slug].json.js\n+ | | | ├ [...slug].svelte\n...\n```\n\nLuego, reemplazamos el contenido:\n\n```javascript\n\u002F\u002F src\u002Froutes\u002Fblog\u002F[...slug].json.js\n\nimport fs from \"fs\";\nimport path from \"path\";\nimport marked from \"marked\";\nimport hljs from \"highlight.js\";\nimport grayMatter from \"gray-matter\";\n\n\u002F*\n * Para obtener el contenido del post\n *\u002F\nfunction getPost(year, month, day, fileName) {\n  return fs.readFileSync(\n    path.resolve(\"content\", `${year}-${month}-${day}_${fileName}.md`),\n    \"utf-8\"\n  );\n}\n\n\u002F*\n * En Sapper, este método responde a una request a través del método GET\n * En nuestro caso, la request de un JSON\n *\u002F\nexport function get(req, res, next) {\n  \u002F\u002F Así es cómo resolvemos una `dynamic route` en Sapper,\n  \u002F\u002F obtenemos cada valor en su variable respectiva\n  let [year, month, day, slug] = req.params.slug;\n\n  const postMarkdown = getPost(year, month, day, slug);\n  const renderer = new marked.Renderer();\n\n  \u002F\u002F marked provee una manera de formatear partes específicas del markdown\n  \u002F\u002F en este caso, el código\n  renderer.code = (source, lang) =\u003E {\n    const { value: highlighted } = hljs.highlight(lang, source);\n    return `\u003Cpre class='language-${lang} overflow-x-auto'\u003E\u003Ccode\u003E${highlighted}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E`;\n  };\n\n  marked.use({ renderer });\n\n  const { data, content } = grayMatter(postMarkdown);\n  const html = marked(content);\n\n  if (html) {\n    res.writeHead(200, { \"Content-Type\": \"application\u002Fjson\" });\n    res.end(JSON.stringify({ html, ...data }));\n  } else {\n    res.writeHead(404, { \"Content-Type\": \"application\u002Fjson\" });\n    res.end(JSON.stringify({ message: `Not found` }));\n  }\n}\n```\n```html\n\u003C!-- src\u002Froutes\u002Fblog\u002F[...slug].svelte --\u003E\n\n\u003Cscript context=\"module\"\u003E\n  \u002F*\n   * Este método representa un paso en el ciclo de vida de un component en Sapper.\n   *\n   * Únicamente se ejecuta cuando el componente es montado. Aquí haremos la petición de nuestro JSON con la información del post\n   *\u002F\n  export async function preload({ params }) {\n    let [year, month, day, slug] = params.slug;\n\n    const res = await this.fetch(`blog\u002F${year}\u002F${month}\u002F${day}\u002F${slug}.json`);\n    const data = await res.json();\n\n    if (res.status === 200) {\n      return { post: data };\n    } else {\n      this.error(res.status, data.message);\n    }\n  }\n\u003C\u002Fscript\u003E\n\n\u003Cscript\u003E\n  export let post;\n\u003C\u002Fscript\u003E\n\n\u003Csvelte:head\u003E\n  \u003Ctitle\u003E{post.title} by {post.author}\u003C\u002Ftitle\u003E\n\u003C\u002Fsvelte:head\u003E\n\n\u003Carticle\u003E\n  {@html post.html}\n\u003C\u002Farticle\u003E\n```\n\nDe esta forma se renderizará el post. Ya puedes verlo en tu ambiente local yendo a [\u002Fblog\u002F2020\u002F08\u002F08\u002Fhola-mundo](http:\u002F\u002Flocalhost:3000\u002Fblog\u002F2020\u002F08\u002F08\u002Fhola-mundo).\n\nAún hay un pequeño detalle que debemos cubrir para cumplir con las reglas que _Sapper_ establece si queremos exportar nuestro pequeño blog como un sitio estático.\n\n\u003E \"... cualquier página que quieras que sea incluída en el sitio (estático) exportado debe ser esta ligado con una etiqueta del tipo \\\u003Ca\\\u003E o añadida cómo parametro de la opción  --entry del comando `sapper export`\" de [Sapper docs](https:\u002F\u002Fsapper.svelte.dev\u002Fdocs#How_it_works).\n\nDe acuerdo a la documentación, debemos incluir elementos **\\\u003Ca\\\u003E** que apunten a nuestras páginas generadas a partir de rutas dinámicas, para que al exportar el sitio estas también se incluyan. Por eso programaremos el endpoint [\u002Fblog](http:\u002F\u002Flocalhost:3000\u002Fblog).\n\n```javascript\n\u002F\u002F src\u002Froutes\u002Fblog\u002Findex.json.js\n\nimport fs from \"fs\";\nimport path from \"path\";\nimport grayMatter from \"gray-matter\";\n\nfunction getAllPosts() {\n  const posts = fs\n    .readdirSync(\"content\")\n    .map((fileName) =\u003E {\n      const post = fs.readFileSync(path.resolve(\"content\", fileName), \"utf-8\");\n      return grayMatter(post).data;\n    })\n    .sort((a, b) =\u003E {\n      if (b.timestamp \u003C a.timestamp) return -1;\n      if (b.timestamp \u003E a.timestamp) return 1;\n\n      return 0;\n    });\n  return posts;\n}\n\nexport function get(req, res) {\n  res.writeHead(200, { \"Content-Type\": \"application\u002Fjson\" });\n  res.end(JSON.stringify(getAllPosts()));\n}\n```\n```html\n\u003C!-- src\u002Froutes\u002Fblog\u002Findex.svelte --\u003E\n\n\u003Cscript context=\"module\"\u003E\n  export function preload({ params, query }) {\n    return this.fetch(`blog.json`)\n      .then((r) =\u003E r.json())\n      .then((posts) =\u003E ({\n        posts: posts.map((post) =\u003E {\n          const timestamp = new Date(post.timestamp);\n          return {\n            ...post,\n            timestamp,\n            date: {\n              year: timestamp.getFullYear(),\n              month: `${timestamp.getMonth() + 1}`.padStart(2, `0`),\n              day: `${timestamp.getDate()}`.padStart(2, `0`),\n            },\n          };\n        }),\n      }));\n  }\n\u003C\u002Fscript\u003E\n\n\u003Cscript\u003E\n  export let posts;\n\u003C\u002Fscript\u003E\n\n\u003Csvelte:head\u003E\n  \u003Ctitle\u003EBlog | Mario Menjívar\u003C\u002Ftitle\u003E\n\u003C\u002Fsvelte:head\u003E\n\n\u003Cul\u003E\n  {#each posts as post}\n  \u003Cli\u003E\n    \u003Ca\n      rel=\"prefetch\"\n      href=\"blog\u002F{post.date.year}\u002F{post.date.month}\u002F{post.date.day}\u002F{post.slug}\"\n    \u003E\n      {post.title}\n    \u003C\u002Fa\u003E\n    \u003Cp class=\"c-label-last-updated\"\u003E\n      Posted on {post.timestamp.toLocaleString()} by {post.author}\n    \u003C\u002Fp\u003E\n  \u003C\u002Fli\u003E\n  {\u002Feach}\n\u003C\u002Ful\u003E\n```\n\nListo.\n\n## Sitio estático\n\nAntes de desplegar nuestro fantástico blog, necesitamos asegurarnos que las páginas estáticas se generaran sin problemas. Para eso necesitamos ejecutar lo siguiente en la línea de comandos:\n\n```bash\n[user@host my-blog]$ npm run export\n[user@host my-blog]$ npx serve __sapper__\u002Fexport\n```\n\nSi no tienes ningun problema al acceder a este endpoint [\u002Fblog\u002F2020\u002F08\u002F08\u002Fhola-mundo](http:\u002F\u002Flocalhost:5000\u002Fblog\u002F2020\u002F08\u002F08\u002Fhola-mundo), ¡Felicidades! solo nos queda desplegar el sitio.\n\n\n## Despliegue: Github Pages\n\nNuestro sitio estático ha sido generado y los archivos están dentro de la carpeta `__sapper__\u002Fexport`. Existen una infinidad de servicios que te permiten almacenar y servir este tipo de sitios, entre los más populares tenemos Netlify o Github Pages. En este post te mostraré cómo hacerlo con _Github Pages_.\n\nPodríamos subir el folder `__sapper__\u002Fexport` a un nuevo repositorio, activar la opción _Github Pages_ y repetir este proceso manualmente cada vez que actualicemos nuestro sitio con un nuevo post. En mi opinión, hacerlo de manera manual le quita la diversión. Afortunadamente, exite _Github Actions_.\n\nEl primer paso es crear dos repositorios en _Github_, el primero es el repositorio de nuestro projecto y el segundo el repositorio al cuál subiremos nuestro sitio estático. En mi caso, [mariomenjr\u002Fmariomenjr](https:\u002F\u002Fgithub.com\u002Fmariomenjr\u002Fmariomenjr) y [mariomenjr\u002Fmariomenjr.github.io](https:\u002F\u002Fgithub.com\u002Fmariomenjr\u002Fmariomenjr.github.io) respectivamente. Una vez hecho esto, creamos los siguientes folders y archivos en el folder del projecto:\n\n```text\n...\n├ .github\n│ ├ workflows\n| | | deploy.yml\n├ src\n...\n```\n```yml\n# .github\u002Fworkflows\u002Fdeploy.yml\n\nname: Build and deploy\non:\n    push:\n      branches: \n        # Únicamente cuando actualicemos master\n        - master\njobs:\n  build-and-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout 🛎️\n        uses: actions\u002Fcheckout@v2.3.1\n        with:\n          persist-credentials: false\n      - name: Install and build\n        run: |\n          npm install\n          npm run export\n      - name: Deploy 🚀\n        uses: JamesIves\u002Fgithub-pages-deploy-action@3.5.9\n        with:\n          # Limpiará el despliegue previo\n          CLEAN: true\n          # Necesitamos crear este secret para el repositorio\n          GITHUB_TOKEN: ${{ secrets.DEPLOY_MARIOMENJR }}\n          BRANCH: master\n          FOLDER: __sapper__\u002Fexport\n          BASE_BRANCH: master\n          REPOSITORY_NAME: mariomenjr\u002Fmariomenjr.github.io\n\n```\n\nEl archivo anterior se explica en la [documentación](https:\u002F\u002Fgithub.com\u002Fmarketplace\u002Factions\u002Fdeploy-to-github-pages) de la acción. En este post nos centraremos en un línea 1 línea: \n\n```yml\n...\njobs:\n  build-and-deploy:\n    ...\n    steps:\n      ...\n      - name: Deploy 🚀\n        ...\n        with:\n          ...\n          # Necesitamos crear este secret para el repositorio\n          GITHUB_TOKEN: ${{ secrets.DEPLOY_MARIOMENJR }}\n          ...\n```\n\nEs esta línea la que autoriza a la acción a hacer cambios al repositorio `mariomenjr\u002Fmariomenjr.github.io`.\n\nPara generar tu _Github token_, dirígete a [github.com\u002Fsettings\u002Ftokens](https:\u002F\u002Fgithub.com\u002Fsettings\u002Ftokens), haz clic en el botón `Generate new token`, escribe un nombre significativo en el campo `Note`, selecciona el _checkbox_ **_repo_** y, por último, haz clic en el botón `Generate token`.\n\n![Github personal access tokens](https:\u002F\u002Fimgur.com\u002FHbbMgm7.png)\n\nNo olvides copiar el token.\n\nPor último, dirígete al repositorio del projecto para crear la variable de entorno que incluirás en el archivo `deploy.yml`.\n\n![Add secret to repository](https:\u002F\u002Fimgur.com\u002FiuyGLdc.png)\n\n```yml\n...\njobs:\n  build-and-deploy:\n    ...\n    steps:\n      ...\n      - name: Deploy 🚀\n        ...\n        with:\n          ...\n          # Necesitamos crear este secret para el repositorio\n          GITHUB_TOKEN: ${{ secrets.MI_VARIABLE }}\n          ...\n```\n\nListo. Tan pronto hagas push al repositorio del projecto, _Github Actions_ desplegará tu sitio estático.\n\n![Github Action Deployment](https:\u002F\u002Fimgur.com\u002FfHxzGuf.png)\n\n# Conclusión\n\nPuedes usar WordPress, Ghosts, incluso Jekyll si lo prefieres. El objetivo de este post es mostrarte como todas esas herramientas tienen su origen en cosas básicas que con el tiempo se convierten en herramientas robustas listas para sacarles provecho.\n\nMe decidí a construir este blog, de esta manera, para poner en práctica el concepto [Aprender en Público](https:\u002F\u002Fricardoerl.com\u002Fblog\u002Faprender-en-publico) que presentó [Ricardo](https:\u002F\u002Fricardoerl.com), un desarrollador salvadoreño, en un charla de [Café Digital](https:\u002F\u002Ftwitter.com\u002Fcafedigitalsv) y así salir de mi zona de comfort. Creéme cuando te digo que me divertí.\n\n\n# Referencias\n\n- [Building a blog with Svelte, Sapper, and Markdown](https:\u002F\u002Fwww.mahmoudashraf.dev\u002Fblog\u002Fbuild-a-blog-with-svelte-and-markdown\u002F) \n- [Sapper docs](https:\u002F\u002Fsapper.svelte.dev\u002Fdocs#How_it_works)\n- [Static Svelte: JavaScript Blogging with 93% less JavaScript](https:\u002F\u002Fwww.swyx.io\u002Fwriting\u002Fsvelte-static\u002F)\n- [Markdown](https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FMarkdown)"}]}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.8e524d91.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main","/client/client.8e524d91.js")}document.head.appendChild(s)</script> 